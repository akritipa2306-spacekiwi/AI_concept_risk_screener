<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Governance Evaluation Results</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
<style>
  .score-card {
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
    background: linear-gradient(135deg, #f0fdfa 0%, #ecfeff 100%) !important;
    border-radius: 16px;
    padding: 32px 24px !important;
    box-shadow: 0 8px 32px rgba(6, 182, 212, 0.15);
    margin-bottom: 28px;
    text-align: center;
    overflow: visible !important;
    border: 1px solid #a7f3d0;
  }
  .score-dashboard {
    display: flex;
    flex-direction: column;
    align-items: center;
    margin-bottom: 20px;
  }
  .score-number-large {
    font-size: 80px;
    font-weight: 800;
    line-height: 1;
    margin-bottom: 8px;
  }
  .score-number-large.score-green { color: #10b981; }
  .score-number-large.score-yellow { color: #f59e0b; }
  .score-number-large.score-red { color: #ef4444; }
  .score-subtitle {
    font-size: 13px;
    font-weight: 600;
    color: #64748b;
    text-transform: uppercase;
    letter-spacing: 1.5px;
  }
  .score-divider {
    width: 80%;
    height: 2px;
    background: linear-gradient(90deg, transparent, #06b6d4, transparent);
    margin: 20px 0;
  }
  .score-details {
    display: grid !important;
    grid-template-columns: repeat(5, 1fr) !important;
    gap: 16px !important;
    text-align: center;
    width: 100%;
    flex-direction: unset !important;
  }
  .score-item {
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
    background: white;
    border-radius: 12px;
    padding: 16px 12px !important;
    min-width: 0;
    overflow: visible !important;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
    border: 1px solid #e2e8f0;
  }
  .score-item-label {
    font-size: 10px;
    font-weight: 700;
    color: #475569;
    text-transform: uppercase;
    letter-spacing: 0.3px;
    margin-bottom: 10px;
    white-space: normal !important;
    overflow: visible !important;
    text-overflow: unset !important;
    text-align: center;
    line-height: 1.4;
    min-width: unset !important;
  }
  .score-bar-container {
    width: 100%;
    height: 8px;
    background: #e2e8f0;
    border-radius: 4px;
    overflow: hidden;
    margin-bottom: 10px;
    flex: unset !important;
  }
  .score-bar {
    height: 100%;
    border-radius: 4px;
    transition: width 0.5s ease;
  }
  .bar-green { background: linear-gradient(90deg, #10b981, #34d399); }
  .bar-yellow { background: linear-gradient(90deg, #f59e0b, #fbbf24); }
  .bar-red { background: linear-gradient(90deg, #ef4444, #f87171); }
  .score-badge {
    display: inline-block;
    padding: 6px 14px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 700;
    white-space: nowrap;
    min-width: unset !important;
  }
  .badge-green { background: #d1fae5; color: #065f46; }
  .badge-yellow { background: #fef3c7; color: #92400e; }
  .badge-red { background: #fee2e2; color: #991b1b; }
  .badge-excellent { background: #d1fae5; color: #065f46; }
  .badge-moderate { background: #fef3c7; color: #92400e; }
  .badge-weak { background: #fee2e2; color: #991b1b; }
  .badge-strong { background: #d1fae5; color: #065f46; }
  
  @media (max-width: 900px) {
    .score-details {
      grid-template-columns: repeat(3, 1fr) !important;
    }
  }
  @media (max-width: 600px) {
    .score-details {
      grid-template-columns: repeat(2, 1fr) !important;
    }
    .score-number-large {
      font-size: 60px;
    }
  }
  @media (max-width: 400px) {
    .score-details {
      grid-template-columns: 1fr !important;
    }
  }
  
  .view-report-section {
    text-align: center;
    margin: 32px 0;
    padding: 24px;
    background: linear-gradient(135deg, #ecfeff 0%, #f0fdfa 100%);
    border-radius: 16px;
    border: 2px dashed #06b6d4;
  }
  .btn-view-report {
    display: inline-block;
    padding: 16px 48px;
    font-size: 18px;
    font-weight: 700;
    color: white;
    background: linear-gradient(135deg, #0891b2 0%, #06b6d4 50%, #5eead4 100%);
    border-radius: 12px;
    text-decoration: none;
    box-shadow: 0 6px 24px rgba(6, 182, 212, 0.35);
    transition: all 0.3s ease;
  }
  .btn-view-report:hover {
    transform: translateY(-3px);
    box-shadow: 0 8px 32px rgba(6, 182, 212, 0.45);
  }
  .report-hint {
    margin-top: 12px;
    font-size: 14px;
    color: #64748b;
  }
</style>
<div class="page">
  <header class="top-bar">
    <div class="logo-pill">AI</div>
    <div class="top-text">
      <div class="top-title">Governance Ideation</div>
      <div class="top-subtitle">Lightweight MVP for early-stage startups</div>
    </div>
  </header>

  <main class="card">
    <div class="results-header">
      <h1>Governance Evaluation</h1>
      <p class="intro">Here's the detailed assessment of your AI system idea based on governance best practices.</p>
    </div>

    {% if error %}
      <div class="result error">{{ error }}</div>
      <div class="actions" style="margin-top: 24px;">
        <a href="/" class="btn-secondary">← Back to Wizard</a>
      </div>
    {% endif %}

    {% if result %}
      {% if scores and scores.overall_score is defined %}
      <div class="score-card">
        <div class="score-dashboard">
          <div class="score-number-large {% if scores.overall_score >= 70 %}score-green{% elif scores.overall_score >= 40 %}score-yellow{% else %}score-red{% endif %}">
            {{ scores.overall_score }}
          </div>
          <div class="score-subtitle">NIST-Weighted Governance Score</div>
        </div>
        <div class="score-divider"></div>
        <div class="score-details">
          {% if scores.external_impact is defined %}
          <div class="score-item">
            <div class="score-item-label">External Impact Risk</div>
            <div class="score-bar-container">
              <div class="score-bar {% if scores.external_impact == 'Low' %}bar-green{% elif scores.external_impact == 'Medium' %}bar-yellow{% else %}bar-red{% endif %}" 
                   style="width: {% if scores.external_impact == 'Low' %}30{% elif scores.external_impact == 'Medium' %}60{% else %}90{% endif %}%"></div>
            </div>
            <span class="score-badge {% if scores.external_impact == 'Low' %}badge-green{% elif scores.external_impact == 'Medium' %}badge-yellow{% else %}badge-red{% endif %}">
              {{ scores.external_impact }}
            </span>
          </div>
          {% endif %}
          {% if scores.internal_failure is defined %}
          <div class="score-item">
            <div class="score-item-label">Internal Failure Risk</div>
            <div class="score-bar-container">
              <div class="score-bar {% if scores.internal_failure == 'Low' %}bar-green{% elif scores.internal_failure == 'Medium' %}bar-yellow{% else %}bar-red{% endif %}"
                   style="width: {% if scores.internal_failure == 'Low' %}30{% elif scores.internal_failure == 'Medium' %}60{% else %}90{% endif %}%"></div>
            </div>
            <span class="score-badge {% if scores.internal_failure == 'Low' %}badge-green{% elif scores.internal_failure == 'Medium' %}badge-yellow{% else %}badge-red{% endif %}">
              {{ scores.internal_failure }}
            </span>
          </div>
          {% endif %}
          {% if scores.regulatory_sensitivity is defined %}
          <div class="score-item">
            <div class="score-item-label">Regulatory Sensitivity</div>
            <div class="score-bar-container">
              <div class="score-bar {% if scores.regulatory_sensitivity == 'Low' %}bar-green{% elif scores.regulatory_sensitivity == 'Medium' %}bar-yellow{% else %}bar-red{% endif %}"
                   style="width: {% if scores.regulatory_sensitivity == 'Low' %}30{% elif scores.regulatory_sensitivity == 'Medium' %}60{% else %}90{% endif %}%"></div>
            </div>
            <span class="score-badge {% if scores.regulatory_sensitivity == 'Low' %}badge-green{% elif scores.regulatory_sensitivity == 'Medium' %}badge-yellow{% else %}badge-red{% endif %}">
              {{ scores.regulatory_sensitivity }}
            </span>
          </div>
          {% endif %}
          {% if scores.data_legal_soundness is defined %}
          <div class="score-item">
            <div class="score-item-label">Data & Legal Soundness</div>
            <div class="score-bar-container">
              <div class="score-bar {% if scores.data_legal_soundness == 'Excellent' %}bar-green{% elif scores.data_legal_soundness == 'Moderate' %}bar-yellow{% else %}bar-red{% endif %}"
                   style="width: {% if scores.data_legal_soundness == 'Excellent' %}30{% elif scores.data_legal_soundness == 'Moderate' %}60{% else %}90{% endif %}%"></div>
            </div>
            <span class="score-badge {% if scores.data_legal_soundness == 'Excellent' %}badge-excellent{% elif scores.data_legal_soundness == 'Moderate' %}badge-moderate{% else %}badge-weak{% endif %}">
              {{ scores.data_legal_soundness }}
            </span>
          </div>
          {% endif %}
          {% if scores.purpose_clarity is defined %}
          <div class="score-item">
            <div class="score-item-label">Purpose & MVP Clarity</div>
            <div class="score-bar-container">
              <div class="score-bar {% if scores.purpose_clarity == 'Strong' %}bar-green{% elif scores.purpose_clarity == 'Moderate' %}bar-yellow{% else %}bar-red{% endif %}"
                   style="width: {% if scores.purpose_clarity == 'Strong' %}30{% elif scores.purpose_clarity == 'Moderate' %}60{% else %}90{% endif %}%"></div>
            </div>
            <span class="score-badge {% if scores.purpose_clarity == 'Strong' %}badge-strong{% elif scores.purpose_clarity == 'Moderate' %}badge-moderate{% else %}badge-weak{% endif %}">
              {{ scores.purpose_clarity }}
            </span>
          </div>
          {% endif %}
        </div>
      </div>
      
      <div class="view-report-section">
        <a href="/report" target="_blank" class="btn-view-report">View Full Report</a>
        <p class="report-hint">Opens in a new tab. You can download as PDF from there.</p>
      </div>
      {% endif %}
      
      <div class="results-actions">
        <button onclick="startNewEvaluation()" class="btn-secondary">← Start New Evaluation</button>
      </div>
    {% endif %}
  </main>
</div>

<script>
function startNewEvaluation() {
  // Clear all form data from sessionStorage
  Object.keys(sessionStorage).forEach(key => {
    if (key.startsWith('gov_')) {
      sessionStorage.removeItem(key);
    }
  });
  // Redirect to the form
  window.location.href = '/';
}
</script>
</body>
</html>
